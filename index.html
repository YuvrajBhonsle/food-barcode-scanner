<!DOCTYPE html>
<html>
<head>
  <title>FoodScanGenius</title>
</head>
<body>
  <h1>FoodScanGenius</h1>
  <p>Welcome! Select a barcode from the list or enter it manually:</p>
  <select id="barcodeSelect" onchange="checkBarcodeInput(this)">
    <option value="">Select Barcode</option>
    <option value="021000010875">021000010875</option>
    <option value="021000010882">021000010882</option>
    <option value="021000028207">021000028207</option>
    <option value="021000658831">021000658831</option>
    <option value="021000658862">021000658862</option>
    <option value="012546008679">012546008679</option>
    <option value="012546008693">012546008693</option>
    <option value="019320068331">019320068331</option>
    <option value="044000029555">044000029555</option>
    <option value="019320013744">019320013744</option>
    <option value="028400154437">028400154437</option>
    <option value="028400443555">028400443555</option>
    <option value="028400000222">028400000222</option>
    <option value="028400249645">028400249645</option>
    <option value="028400000789">028400000789</option>
    <option value="012000018794">012000018794</option>
    <option value="012000809958">012000809958</option>
    <option value="012000381232">012000381232</option>
    <option value="012000620362">012000620362</option>
    <option value="012000100482">012000100482</option>
    <option value="034000011605">034000011605</option>
    <option value="034000040476">034000040476</option>
    <option value="036632014009">036632014009</option>
    <option value="068274934711">068274934711</option>
    <option value="050000111879">050000111879</option>
  </select>
  <input type="text" id="manualBarcodeInput" placeholder="Enter Barcode" oninput="checkBarcodeInput(this)">
  <button onclick="getBarcodeDetails()">Analyze</button>

  <div id="result"></div>
  <div id="navigation">
    <a href="aboutus.html">About Us</a>
    <a href="faq.html">FAQ</a>
    <a href="fsg.html">Why FoodScanGenius</a>
    <a href="foodchoice.html">Food Choices</a>  
  </div>

  <script>
    var barcodeInput = null;

    function checkBarcodeInput(inputElement) {
      barcodeInput = inputElement.value;
    }

    function getBarcodeDetails() {
      var selectedBarcode = barcodeInput;

      if (selectedBarcode) {
        var apiURL = "http://ec2-13-49-238-207.eu-north-1.compute.amazonaws.com:9090/barcode/v1/barcode";

        // Make AJAX request
        var xhr = new XMLHttpRequest();
        xhr.open("POST", apiURL, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var response = JSON.parse(xhr.responseText);

            // Process the response and display the results
            displayResults(response);
          } else {
            // Display error message if the request fails
            displayError();
          }
        };
        xhr.send(JSON.stringify({ number: selectedBarcode }));
      } else {
        // Display error message if no barcode is selected
        displayError();
      }
    }

    function displayResults(response) {
      var resultContainer = document.getElementById("result");
      resultContainer.innerHTML = ""; // Clear previous results

      if (response.status === 1) {
        var product = response.product;
        var resultHTML = "<h2>Product Information</h2>";
        resultHTML += "<pre>" + JSON.stringify(product, null, 2) + "</pre>";
        resultContainer.innerHTML = resultHTML;
      } else {
        displayError();
      }
    }

    function displayError() {
      var resultContainer = document.getElementById("result");
      resultContainer.innerHTML = "<p class='error'>Error: Unable to retrieve barcode information.</p>";
    }
  </script>
</body>
</html>
